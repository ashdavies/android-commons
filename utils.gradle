def getProperties(String path) {
  Properties properties = new Properties()
  file(path).withInputStream { stream ->
    properties.load(stream)
  }
  return properties;
}

def getGitHash = { ->
  def stdout = new ByteArrayOutputStream()
  exec {
    commandLine 'git', 'rev-parse', '--short', 'HEAD'
    standardOutput = stdout
  }
  return stdout.toString().trim()
}

def getGitTag = { ->
  def stdout = new ByteArrayOutputStream()
  exec {
    commandLine 'git', 'describe', '--tags'
    standardOutput = stdout
  }
  return stdout.toString().trim()
}

def getVersionCode(String path) {
  return Integer.valueOf(getProperties(path)['version.code'].toString())
}

def getVersionName(String path) {
  return getProperties(path)['version.name']
}

ext {
  getProperties = this.&getProperties

  getGitHash = this.&getGitHash
  getgitTag = this.&getGitTag

  getVersionCode = this.&getVersionCode
  getVersionName = this.&getVersionName
}
